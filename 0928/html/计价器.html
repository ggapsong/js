<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="../style/jijiaqi.css">
</head>

<body>
    <div class="box">
        <ul class="list">
            <li>
                <div class="left">
                    <div class="jian">-</div>
                    <div class="num">0</div>
                    <div class="add">+</div>
                </div>
                <div class="right">
                    <div class="price">单价:<span>12.5</span>元</div>
                    <div class="money">小计:<span>0元</span></div>
                </div>
            </li>
            <li>
                <div class="left">
                    <div class="jian">-</div>
                    <div class="num">0</div>
                    <div class="add">+</div>
                </div>
                <div class="right">
                    <div class="price">单价:<span>10.5</span>元</div>
                    <div class="money">小计:<span>0元</span></div>
                </div>
            </li>
            <li>
                <div class="left">
                    <div class="jian">-</div>
                    <div class="num">0</div>
                    <div class="add">+</div>
                </div>
                <div class="right">
                    <div class="price">单价:<span>8.5</span>元</div>
                    <div class="money">小计:<span>0元</span></div>
                </div>
            </li>
            <li>
                <div class="left">
                    <div class="jian">-</div>
                    <div class="num">0</div>
                    <div class="add">+</div>
                </div>
                <div class="right">
                    <div class="price">单价:<span>8</span>元</div>
                    <div class="money">小计:<span>0元</span></div>
                </div>
            </li>
            <li>
                <div class="left">
                    <div class="jian">-</div>
                    <div class="num">0</div>
                    <div class="add">+</div>
                </div>
                <div class="right">
                    <div class="price">单价:<span>14.5</span>元</div>
                    
                    <div class="money">小计:<span>0元</span></div>
                </div>
            </li>
        </ul>
        <div class="bottom">
            <div class="business">
                <div class="bleft">商品共合计：<div class="packages">0</div>件</div>
                <div class="bright">共花费了：<div class="packages">0</div>元</div>
            </div>
            <div class="expensive">其中最贵的商品单价是：
                <div class="packages"></div>
                元
            </div>
        </div>
    </div>
</body>
<script> 
    var jian = document.querySelectorAll(".jian");
    var add = document.querySelectorAll(".add");
    var num = document.querySelectorAll(".num");
    var prices = document.querySelectorAll('.price span');
    var itemTotalSale = document.querySelectorAll('.money span');
    var totalBox = document.querySelector('.bleft .packages');
    var totalMoney = document.querySelector('.bright .packages');
    
    for(let i=0;i<jian.length;i++){
        jian[i].onclick=function(){
            if(num[i].innerHTML<=0) return false;
            var n = num[i].innerHTML;
            var total = totalBox.innerHTML;
            n--;
            total--;
            scalePrice(i,n);
            totalBox.innerHTML = total;
            num[i].innerHTML = n;
            scaleTotalMoney();
            scaleMaxPrice();
            document.querySelector('.expensive .packages').innerHTML = scaleMaxPrice();
        };
        add[i].onclick=function(){
            var n = num[i].innerHTML;
            var total = totalBox.innerHTML;
            n++;
            total++;
            scalePrice(i,n);
            totalBox.innerHTML = total;
            num[i].innerHTML = n;
            scaleTotalMoney();
            
            document.querySelector('.expensive .packages').innerHTML = scaleMaxPrice();
        };
    }
    function scalePrice(index,num){
        itemTotalSale[index].innerHTML = prices[index].innerHTML * num + '元';
    }
    function scaleTotalMoney(){
        var num = 0;
        for (let i = 0; i < itemTotalSale.length; i++) {
            num += parseFloat(itemTotalSale[i].innerHTML);
        };
        totalMoney.innerHTML = num;
    }
    function scaleMaxPrice(){
        var max = 0;
        for (let i = 0; i < num.length; i++) {
            if(num[i].innerHTML>0 && prices[i].innerHTML>max){
                max = Number(prices[i].innerHTML);
            }
        };
        return max;
    }
</script>
</html>